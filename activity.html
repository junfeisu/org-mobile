<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>团队活动</title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/app.css" />
		<link rel="stylesheet" href="css/activity.css" />
 		<script>
			window.onload = function() {
					waterFall("wrap")
				} //
			window.onresize = function() {
				waterFall("wrap")
			}

			function waterFall(element, space, children) {
				if (!element) return;
				space = space || 20;
				children = children || "div"; //前三行默认设置，分别为外框元素id，上下留白，子元素标签名(子元素标签名使用太多或出错)
				var wrap = document.getElementById(element);
				var water = wrap.getElementsByTagName(children);
				var spaceWidth = water[0].offsetWidth; //获取子元素宽度(offsetWidth会获取块级元素的padding和border)
				var wrapWidth = wrap.offsetWidth; //获取外框元素宽度
				var colNum = Math.floor(wrapWidth / spaceWidth); //计算获取外框元素所能承受列数
				var padding = Math.floor((wrapWidth - colNum * spaceWidth) / (colNum + 1)); //计算外框元素剩余宽度并计算左右留白
				var column = new Array();
				var length = water.length;
				var maxHeight = 0;
				for (var i = 0; i < colNum; i++) { //初始化数组来计算各列初始top值和left值
					column[i] = new Array();
					column[i].top = space;
					column[i].left = (spaceWidth * i) + padding * (i + 1); //计算各列距离左侧距离
				}
				for (var i = 0; i < length; i++) { //遍历所有子元素及瀑布流布局
					var index = i + 1; //计算该子元素属于第几列
					if (index % colNum == 0) {
						sub = colNum;
					} else {
						sub = index % colNum;
					}
					_this = water;
					_this[i].style.position = "absolute";
					_this[i].style.top = column[sub - 1].top + "px";
					_this[i].style.left = column[sub - 1].left + "px";
					column[sub - 1].top += _this[i].offsetHeight + space; //计算各列最新高度以便赋值
				}
				for (var i = 0; i < colNum; i++) { //获取瀑布流整体布局高度
					if (column[i].top > maxHeight) maxHeight = column[i].top;
				}
				wrap.style.height = maxHeight + "px"; //给外框元素赋值以防止出现子元素溢出外框元素
			}
		</script>
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
	</head>
		<body>
			<header class="mui-bar mui-bar-nav">
				<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" href="inner.html"></a>
				<h1 class="mui-title"></h1>
			</header>
			<ul class="mui-table-view head">
				<li class=" mui-table-view-cell ">
					<a class="blue-line-wrapper ">
						<div class="blue-line "></div>
						<span class="mui-pull-right inner-org-name ">团队活动</span>
					</a>
				</li>
			</ul>
			<div class="wrap" id="wrap">
   			</div>
			<script src="js/mui.zoom.js"></script>
			<script src="js/mui.previewimage.js"></script>
			<script type="text/javascript" src="js/jquery.min.js"></script>
			<script type="text/javascript" src="js/share.js"></script>
			<script>
				mui.previewImage();
			</script>
			<script type="text/javascript">
				window.onload=function(){
				    var wrap = document.getElementById('wrap');
				    var org_name = getCookies('comName', '; ', '=');
				    $('.mui-title').html(org_name);
					function autoProduce(data){
						var data=eval(data);
						for(var i=0;i<data.activities.length;i++){
							div=document.createElement('div');
							a=document.createElement('a');
							a.setAttribute('href','javascript:void(0)');
							img=document.createElement('img');
							img.setAttribute('src','http://community.new.ncuhome.cn'+data.activities[i].Poster);
							img.setAttribute('data-preview-src','');
							img.setAttribute('data-preview-group','1');
							a.appendChild(img);
							p=document.createElement('p');
							text=document.createTextNode(data.activities[i].ActivityIntroduction);
							p.appendChild(text);
							div.appendChild(a);
							div.appendChild(p);
							wrap.appendChild(div);
						}
					}

					jsonAjax('community/activity/8','GET','',autoProduce);

				}
			</script>
		</body>

</html>